{% extends "fwpcore.html" %}


{% block title %}
    Selezione e creazione istanze
{% endblock %}

{% block headers %}

    <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false" xmlns="http://www.w3.org/1999/html"
            xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"></script>
    <script language="JavaScript" src="{{ STATIC_URL }}proxyselng.js"></script>

    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}proxyselng.css">

{% endblock %}

{% block navigation %}

    <div class="tabbar">
        <span class="subtab" id="tabsel_proxy">
            AREA PROXY
        </span>
        <span class="subtab" id="tabsel_standalone">
            AREA STANDALONE
        </span>
    </div>

    <div id="proxylisting">

        <table class="proxylistinglayout" id="instances_proxy">
            <thead>
                <tr><td colspan=3>Istanze proxy</td><td class="proxylisting_actions">                    <img src="/static/resource/fwp_newdatasource_networked.png" class="imgbutton" id="btn_newdatasource_networked" title="Crea proxy read/write">
                    <img src="/static/resource/fwp_newdatasource_query.png" class="imgbutton" id="btn_newdatasource_query" title="Crea proxy query">
                    <img src="/static/resource/fwp_newdatasource_networked.png" class="imgbutton" id="btn_newdatasource_linker" title="Crea proxy di collegamento standalone"></td></tr>
            </thead>
            <tbody>
            {% for proxy_id, proxydata in proxiesdj.items %}
                {% if proxydata.type != 'local' %}
                    <tr class="proxylisting_instance">
                        <td class="proxylisting_emblem">
                            <a href="/fwp/proxyng/{{ proxy_id }}/"><img src="/static/resource/{% if proxydata.type == 'query' %}fwp_datasource-query{% endif %}{% if proxydata.type == 'read' or proxydata.type == 'write' or proxydata.type == 'linked' %}fwp_datasource-networked{% endif %}.png" title="Apri istanza"></a>
                        </td>
                        <td class="proxylisting_name">
                            <a href="/fwp/proxyng/{{ proxy_id }}/">{{ proxydata.name }}</a>
                        </td>
                        <td class="proxylisting_type">
                            {% if proxydata.type == 'query' %}Query{% endif %}
                            {% if proxydata.type == 'read' %}Read{% endif %}
                            {% if proxydata.type == 'write' %}Write{% endif %}
                            {% if proxydata.type == 'linked' %}Standalone{% endif %}
                        </td>
                        <td class="proxylisting_actions">
                            <img src="/static/resource/fwp_remove.png" class="btn_proxydelete" id="btn_proxydelete_{{ proxy_id }}" title="Elimina">
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>



        <table class="proxylistinglayout" id="instances_standalone">
            <thead>
            <tr><td colspan=2>Istanze standalone</td>
                <td class="proxylisting_actions">
                    <img src="/static/resource/fwp_newdatasource_local.png" class="imgbutton" id="btn_newdatasource_standalone" title="Crea strumento standalone">
            </td></tr>
            </thead>
            <tbody>
            {% for proxy_id, proxydata in proxiesdj.items %}
                {% if proxydata.type == 'local' %}
                    <tr class="proxylisting_instance">
                        <td class="proxylisting_emblem">
                            <img src="/static/resource/fwp_datasource-local.png">                                    </td>
                        <td class="proxylisting_name">
                            {{ proxydata.name }}
                        </td>
                        <td class="proxylisting_actions">
                            <img src="/static/resource/fwp_remove.png" class="btn_proxydelete" id="btn_proxydelete_{{ proxy_id }}" title="Elimina">
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>

    </div>



{% endblock %}


{% block functionality %}


    <div class="creationdialog" id="proxycreate_readwrite">
        <table class="creatormask" id="layout_createreadwrite">
            <tbody class="tablebanner"><tr>
                <td colspan=5>ISTANZA</td>
            </tr></tbody>
            <tbody class="tablebanner"><tr>
                <td colspan=3>Pertinenza</td><td colspan=2>Contatti</td>
            </tr></tbody>
            <tr>
                <td rowspan=4>
                    <div class="tablemap" id="map_createreadwrite"></div>
                </td>
                <td>
                    <label for="field_createreadwrite_name">Nome</label></td><td><input type="ẗext" id="field_createreadwrite_name">
                </td>
                <td>
                    <label for="field_createreadwrite_owner">Fornitore</label></td>
                <td>
                    <input type="ẗext" id="field_createreadwrite_owner">
                </td>
            </tr>


            <tr>
                <td>
                    <label for="field_createreadwrite_datefrom">Valido dal</label></td><td><input type="ẗext" id="field_createreadwrite_datefrom">
            </td>
                <td><label for="field_createreadwrite_contactname">Nome referente</label></td>
                <td><input type="ẗext" id="field_createreadwrite_contactname"></td>
            </tr>
            <tr>
                <td>

                    <label for="field_createreadwrite_dateto">Valido al</label> <input type="checkbox" id="field_createreadwrite_hasdateto"></td><td><input type="ẗext" id="field_createreadwrite_dateto">
            </td>
                <td><label for="field_createreadwrite_contactname">Email referente</label></td><td><input type="ẗext" id="field_createreadwrite_contactemail"></td>

            </tr>

            <tr>
            <td>

                    <label for="field_createreadwrite_area_geosearch">Area</label> <img class="imgbutton" id="btn_trygeoloc_proxyrw" src="/static/resource/fwp_focus.png"><img class="imgbutton" id="btn_cleangeoloc_proxyrw" src="/static/resource/fwp_clear.png"></td><td>
                    <input type="ẗext" id="field_createreadwrite_area_geosearch">

                </td>
                <td>
                    <label for="field_createreadwrite_contactname">Telefono referente</label></td><td><input type="ẗext" id="field_createreadwrite_contactphone">
                </td>
                </tr>


            <tbody class="tablebanner"><tr>
                <td colspan=5>CATALOGHI</td>
            </tr></tbody>

            <tbody class="tablebanner"><tr>
                <td colspan=3>Nuovo catalogo</td><td colspan=2>Cataloghi inseriti</td>
            </tr></tbody>

            <tr>
                <td rowspan=5>
                    <div class="tablemap" id="map_metareadwrite"></div>
                </td>
                <td>


                    <label for="field_createreadwrite_name">Nome</label></td><td><input type="ẗext" id="field_metareadwrite_name"></td><td id="createdmetalist" rowspan=4 colspan=2></td></tr>
            <tr><td>
                    <label for="field_createreadwrite_datefrom">Valido dal</label> <input type="checkbox" id="field_metareadwrite_hasdatefrom"></td><td><input type="ẗext" id="field_metareadwrite_datefrom"></td></tr>
            <tr><td>
                    <label for="field_createreadwrite_dateto">Valido al</label> <input type="checkbox" id="field_metareadwrite_hasdateto"></td><td><input type="ẗext" id="field_metareadwrite_dateto"></td></tr>

            <tr><td>
                    <label for="field_createreadwrite_area_geosearch">Area</label> <img class="imgbutton" id="btn_trygeoloc_proxyrwmeta" src="/static/resource/fwp_focus.png">
                    <img class="imgbutton" id="btn_cleangeoloc_proxyrwmeta" src="/static/resource/fwp_clear.png"></td><td><input type="ẗext" id="field_metareadwrite_area_geosearch">

                </td>
            </tr>


        </table>
    </div>




    <div class="creationdialog" id="proxycreate_query"></div>


    <div class="creationdialog" id="proxycreate_linked" title="Creazione proxy di collegamento standalone">

        {% if freest|length > 0 %}

            <div class="formbriefing">
                Selezionare uno strumento standalone da inserire in federazione.<br>
                Il processo di federazione collega automaticamente le mappe dell'Archivio pubblico dello strumento standalone al federatore.
            </div>

            <select id="proxycreate_linked_choosesource">
                <option></option>
                {% for proxy_id, proxydata in proxiesdj.items %}
                    {% if proxy_id in  freest %}
                        <option value="{{ proxy_id }}">{{ proxydata.name }}</option>
                    {% endif %}
                {% endfor %}
            </select>


        {% else %}

            <div class="formbriefing">
                Sul sistema non sono presenti istanze standalone non federate.
            </div>

        {% endif %}

    </div>






    <div class="creationdialog" id="proxycreate_standalone" title="Creazione istanza standalone">
        <div class="formbriefing">
            Inserire i parametri di pertinenza dell'istanza standalone e i dati del referente.<br>
        </div>


        <table class="creatormask" id="layout_createstandalone">
            <tbody class="tablebanner"><tr>
                <td colspan=3>Informazioni sull'istanza</td>
            </tr></tbody>
            <tr>
                <td>
                    <div class="tablemap" id="map_createstandalone"></div>
                </td>
                <td>


                    <label for="field_createstandalone_name">Nome</label><br><input type="ẗext" id="field_createstandalone_name"><br>
                    <label for="field_createstandalone_datefrom">Valido dal</label><br><input type="ẗext" id="field_createstandalone_datefrom"><br>

                    <label for="field_createstandalone_dateto">Valido al</label> <input type="checkbox" id="field_createstandalone_hasdateto"><br><input type="ẗext" id="field_createstandalone_dateto"><br>

                    <label for="field_createstandalone_area_geosearch">Area</label> <img class="imgbutton" id="btn_trygeoloc_proxy" src="/static/resource/fwp_focus.png">
                    <img class="imgbutton" id="btn_cleangeoloc_st" src="/static/resource/fwp_clear.png"><br><input type="ẗext" id="field_createstandalone_area_geosearch">

                </td>
                <td>

                    <label for="field_createstandalone_owner">Fornitore</label><br><input type="ẗext" id="field_createstandalone_owner"><br>
                    <label for="field_createstandalone_contactname">Nome referente</label><br><input type="ẗext" id="field_createstandalone_contactname"><br>
                    <label for="field_createstandalone_contactname">Email referente</label><br><input type="ẗext" id="field_createstandalone_contactemail"><br>
                    <label for="field_createstandalone_contactname">Telefono referente</label><br><input type="ẗext" id="field_createstandalone_contactphone">
                </td>
            </tr>
        </table>





    </div>



    <div id="proxymap"></div>



{% endblock %}


{% block starterscript %}
    <script>
        pageInit({{ proxies }});
    </script>
{% endblock %}


{% block contextguide %}

    <div class="help">
        WORK IN PROGRESS
    </div>
{%  endblock %}




