{% extends "fwpcore.html" %}


{% block title %}
    Selezione e creazione istanze
{% endblock %}

{% block headers %}

    <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false" xmlns="http://www.w3.org/1999/html"></script>
    <script language="JavaScript" src="{{ STATIC_URL }}proxyselng.js"></script>

    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}fwstui.css">
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}proxyselng.css">

{% endblock %}

{% block navigation %}

    <div class="tabbar">
        <span class="subtab" id="tabsel_proxy">
            AREA PROXY
        </span>
        <span class="subtab" id="tabsel_standalone">
            AREA STANDALONE
        </span>
    </div>

    <div id="proxylisting">

        <table class="proxylistinglayout" id="instances_proxy">
            <thead>
                <tr><td colspan=3>Istanze proxy</td><td class="proxylisting_actions">                    <img src="/static/resource/fwp_newdatasource_networked.png" class="imgbutton" id="btn_newdatasource_networked" title="Crea proxy read/write">
                    <img src="/static/resource/fwp_newdatasource_query.png" class="imgbutton" id="btn_newdatasource_query" title="Crea proxy query">
                    <img src="/static/resource/fwp_newdatasource_networked.png" class="imgbutton" id="btn_newdatasource_linker" title="Crea proxy di collegamento standalone"></td></tr>
            </thead>
            <tbody>
            {% for proxy_id, proxydata in proxiesdj.items %}
                {% if proxydata.type != 'local' %}
                    <tr class="proxylisting_instance">
                        <td class="proxylisting_emblem">
                            <a href="/fwp/proxyng/{{ proxy_id }}/"><img src="/static/resource/{% if proxydata.type == 'query' %}fwp_datasource-query{% endif %}{% if proxydata.type == 'read' or proxydata.type == 'write' or proxydata.type == 'linked' %}fwp_datasource-networked{% endif %}.png" title="Apri istanza"></a>
                        </td>
                        <td class="proxylisting_name">
                            <a href="/fwp/proxyng/{{ proxy_id }}/">{{ proxydata.name }}</a>
                        </td>
                        <td class="proxylisting_type">
                            {% if proxydata.type == 'query' %}Query{% endif %}
                            {% if proxydata.type == 'read' %}Read{% endif %}
                            {% if proxydata.type == 'write' %}Write{% endif %}
                            {% if proxydata.type == 'linked' %}Standalone{% endif %}
                        </td>
                        <td class="proxylisting_actions">
                            <img src="/static/resource/fwp_remove.png" class="btn_proxydelete" id="btn_proxydelete_{{ proxy_id }}" title="Elimina">
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>



        <table class="proxylistinglayout" id="instances_standalone">
            <thead>
            <tr><td colspan=2>Istanze standalone</td>
                <td class="proxylisting_actions">
                    <img src="/static/resource/fwp_newdatasource_local.png" class="imgbutton" id="btn_newdatasource_standalone" title="Crea strumento standalone">
            </td></tr>
            </thead>
            <tbody>
            {% for proxy_id, proxydata in proxiesdj.items %}
                {% if proxydata.type == 'local' %}
                    <tr class="proxylisting_instance">
                        <td class="proxylisting_emblem">
                            <img src="/static/resource/fwp_datasource-local.png">                                    </td>
                        <td class="proxylisting_name">
                            {{ proxydata.name }}
                        </td>
                        <td class="proxylisting_actions">
                            <img src="/static/resource/fwp_remove.png" class="btn_proxydelete" id="btn_proxydelete_{{ proxy_id }}" title="Elimina">
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>

    </div>



{% endblock %}


{% block functionality %}


    <div id="proxycreate_readwrite"></div>
    <div id="proxycreate_query"></div>


    <div id="proxycreate_linked" title="Creazione proxy di collegamento standalone">

        {% if freest|length > 0 %}

            <div class="formbriefing">
                Selezionare uno strumento standalone da inserire in federazione.<br>
                Il processo di federazione collega automaticamente le mappe dell'Archivio pubblico dello strumento standalone al federatore.
            </div>

            <select id="proxycreate_linked_choosesource">
                <option></option>
                {% for proxy_id, proxydata in proxiesdj.items %}
                    {% if proxy_id in  freest %}
                        <option value="{{ proxy_id }}">{{ proxydata.name }}</option>
                    {% endif %}
                {% endfor %}
            </select>


        {% else %}

            <div class="formbriefing">
                Sul sistema non sono presenti istanze standalone non federate.
            </div>

        {% endif %}

    </div>



    <div id="proxycreate_standalone">

    </div>



    <div id="proxymap"></div>



{% endblock %}


{% block starterscript %}
    <script>
        pageInit({{ proxies }});
    </script>
{% endblock %}


{% block contextguide %}

    <div class="help">
        WORK IN PROGRESS
    </div>
{%  endblock %}




